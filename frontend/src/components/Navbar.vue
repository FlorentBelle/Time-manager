<script setup>
  import { RouterLink } from 'vue-router'
  import router from '../router';
</script>

<template>
    <div class="navbar" role="navigation">
      <div class="navbar-container-title">
        <div class="navbar-icon-title">
          <svg viewBox="-96 -18 594 594.66894">
            <path d="m207.398438 313.148438c-.304688-.746094-.679688-1.457032-1.128907-2.125-.445312-.675782-.953125-1.304688-1.519531-1.867188-4.800781-4.796875-12.574219-4.796875-17.375 0-.570312.5625-1.078125 1.191406-1.523438 1.867188-.445312.667968-.824218 1.378906-1.128906 2.125-.308594.738281-.542968 1.507812-.703125 2.292968-.160156.789063-.242187 1.59375-.242187 2.398438 0 .824218.082031 1.648437.242187 2.457031.167969.785156.402344 1.554687.703125 2.296875.304688.738281.6875 1.445312 1.128906 2.113281.445313.671875.953126 1.296875 1.523438 1.867188 2.3125 2.277343 5.4375 3.542969 8.6875 3.523437.804688.003906 1.605469-.074218 2.394531-.230468.789063-.160157 1.5625-.394532 2.308594-.699219 1.488281-.621094 2.84375-1.527344 3.984375-2.667969.566406-.570312 1.074219-1.195312 1.519531-1.867188.441407-.667968.824219-1.375 1.128907-2.113281.3125-.742187.546874-1.511719.703124-2.296875.160157-.808594.242188-1.632812.242188-2.457031 0-.800781-.082031-1.605469-.242188-2.394531-.160156-.761719-.394531-1.507813-.703124-2.222656zm0 0"/>
            <path d="m193.664062 376.167969c-.785156.15625-1.554687.390625-2.292968.695312-.746094.308594-1.457032.6875-2.125 1.132813-.671875.453125-1.296875.964844-1.871094 1.535156-2.296875 2.308594-3.589844 5.429688-3.597656 8.683594 0 .808594.082031 1.609375.242187 2.398437.15625.789063.390625 1.558594.703125 2.296875.304688.746094.683594 1.457032 1.128906 2.125.886719 1.347656 2.042969 2.503906 3.394532 3.390625.667968.449219 1.378906.824219 2.125 1.132813.738281.304687 1.507812.539062 2.292968.699218.789063.160157 1.589844.246094 2.398438.246094 3.257812-.011718 6.375-1.308594 8.6875-3.597656.566406-.570312 1.074219-1.195312 1.519531-1.871094.449219-.667968.824219-1.378906 1.128907-2.125.3125-.738281.546874-1.507812.703124-2.296875.160157-.789062.242188-1.589843.242188-2.398437 0-3.671875-1.644531-7.160156-4.488281-9.492188-2.84375-2.335937-6.582031-3.269531-10.191407-2.554687zm0 0"/>
            <path d="m207.398438 348.320312c-.3125-.746093-.6875-1.457031-1.128907-2.128906-.445312-.667968-.957031-1.296875-1.519531-1.867187-.578125-.566407-1.199219-1.078125-1.875-1.519531-.667969-.449219-1.378906-.824219-2.125-1.132813-5.402344-2.261719-11.65625-.363281-14.898438 4.519531-.441406.671875-.816406 1.382813-1.128906 2.128906-.3125.742188-.550781 1.503907-.710937 2.296876-.3125 1.582031-.3125 3.214843 0 4.800781.160156.789062.398437 1.558593.710937 2.296875.3125.742187.6875 1.453125 1.128906 2.125.445313.675781.957032 1.296875 1.523438 1.867187.570312.570313 1.191406 1.082031 1.871094 1.527344.660156.441406 1.367187.816406 2.109375 1.125.746093.308594 1.519531.539063 2.308593.703125 1.585938.308594 3.207032.308594 4.792969 0 .785157-.15625 1.554688-.394531 2.292969-.703125.746094-.300781 1.457031-.683594 2.125-1.125.679688-.445313 1.304688-.957031 1.875-1.527344.5625-.570312 1.074219-1.191406 1.519531-1.867187.441407-.671875.816407-1.382813 1.128907-2.125.308593-.738282.542968-1.507813.703124-2.296875.324219-1.585938.324219-3.21875 0-4.800781-.160156-.792969-.394531-1.554688-.703124-2.296876zm0 0"/>
            <path d="m258.183594 235.519531c2.457031-2.246093 5.023437-4.542969 7.691406-6.914062 32.199219-28.761719 80.15625-71.636719 87.652344-159.8125h31.199218c6.785157 0 12.289063-5.5 12.289063-12.28125v-44.226563c0-6.78125-5.503906-12.285156-12.289063-12.285156h-377.332031c-6.785156 0-12.285156 5.503906-12.285156 12.285156v44.226563c0 6.78125 5.5 12.28125 12.285156 12.28125h31.199219c7.496094 88.175781 55.453125 131.050781 87.65625 159.8125 2.664062 2.371093 5.234375 4.667969 7.6875 6.914062 22.113281 20.109375 31.054688 29.65625 31.054688 43.230469 0 13.578125-8.992188 23.121094-31.054688 43.226562-2.453125 2.253907-5.023438 4.546876-7.679688 6.917969-32.210937 28.757813-80.167968 71.632813-87.664062 159.8125h-31.199219c-6.785156 0-12.285156 5.5-12.285156 12.285157v44.222656c0 6.785156 5.5 12.289062 12.285156 12.289062h377.332031c6.785157 0 12.289063-5.503906 12.289063-12.289062v-44.222656c0-6.785157-5.503906-12.285157-12.289063-12.285157h-31.199218c-7.496094-88.179687-55.453125-131.054687-87.664063-159.8125-2.65625-2.371093-5.222656-4.664062-7.679687-6.917969-22.113282-20.105468-31.054688-29.648437-31.054688-43.226562 0-13.574219 8.992188-23.121094 31.054688-43.230469zm70.636718-166.726562c-3.035156 32.273437-12.035156 57.527343-23.773437 77.980469h-217.972656c-11.734375-20.453126-20.753907-45.707032-23.785157-77.980469zm-87.183593 271.378906c2.457031 2.300781 5.148437 4.644531 7.859375 7.074219 30.714844 27.421875 72.101562 64.46875 79.335937 141.5h-27.023437l-82.839844-69.800782c-13.210938-11.171874-32.554688-11.171874-45.769531 0l-82.835938 69.800782h-27.023437c7.230468-77.03125 48.644531-114.078125 79.332031-141.5 2.714844-2.453125 5.355469-4.773438 7.863281-7.074219 18.144532-16.523437 33.09375-30.183594 37.636719-49.136719h15.875c4.492187 18.917969 19.445313 32.582032 37.589844 49.136719zm0 0"/>
        </svg>
        </div>
        <h1 class="navbar-title">Time manager</h1>
      </div>
      <div class="navbar-container-items">
        <ul v-if="this.$store.state.userConnected.isConnected" class="navbar-list-items">
          <li class="navbar-items">
            <RouterLink to="/home">Home</RouterLink>
          </li>
          <li class="navbar-items">
            <RouterLink :to="'/clock/' + this.$store.state.userConnected.username">Clock</RouterLink>
          </li>
          <li class="navbar-items">
            <RouterLink :to="'/working_times/' + this.$store.state.userConnected.id">Working times</RouterLink>
          </li>
          <li class="navbar-items">
            <RouterLink :to="'/chart_manager/' + this.$store.state.userConnected.id">Dashboard</RouterLink>
          </li>
          <li class="navbar-items">
            <RouterLink :to="'/users/' + this.$store.state.userConnected.id">Profile</RouterLink>
          </li>
        </ul>
      </div>
      <div class="navbar-container-disconnect">
        <button v-if="this.$store.state.userConnected.isConnected" class="noselect navbar-button-disconnect" role="link" v-on:click="disconnectUser()">
          <div class='text'>Log out</div>
	        <div class="icon">
            <svg viewBox="0 0 32 32" >
              <g>
                <path d="m16 31c7.55286 0 13.69751-6.14514 13.69751-13.69849 0-4.87958-2.62427-9.4278-6.84778-11.86951-.48413-.27856-1.04413-.35492-1.58588-.2099-.53986.1441-.99036.48987-1.2699.97351-.27948.48315-.35345 1.04651-.20935 1.58588.14404.53937.48987.99036.97302 1.26941 2.93542 1.69727 4.75952 4.85895 4.75952 8.25061 0 5.24847-4.26965 9.51813-9.51715 9.51813s-9.51715-4.26965-9.51715-9.51813c0-3.39166 1.8241-6.55334 4.75952-8.25061.48315-.27905.82898-.73004.97302-1.26941.1441-.53937.07013-1.10272-.20935-1.58636-.57825-.99561-1.85968-1.33899-2.85577-.76312-4.22351 2.44171-6.84778 6.98993-6.84778 11.86951.00001 7.55334 6.14466 13.69848 13.69752 13.69848z"/>
                <path d="m16 11.79755c1.15265 0 2.09015-.93744 2.09015-2.09015v-6.61725c0-1.15265-.9375-2.09015-2.09015-2.09015s-2.09015.9375-2.09015 2.09015v6.61725c0 1.15271.9375 2.09015 2.09015 2.09015z"/>
              </g>
            </svg>
          </div>
        </button>
      </div>
    </div>
</template>

<script>
  export default {
    data() {
      return {
        user: {
          username:"",
          id: "",
          email: ""
        },
        userConnected: {
          isConnected: false,
          id:-1,
          username:"",
          email:""
        },
        // isSession: false
      }
    },
    // mounted() {
    //   if(localStorage && localStorage.userConnected) {
    //     const parsedUserConnected = JSON.parse(localStorage.userConnected)
    //     console.log("parsedUserConnected", parsedUserConnected)
    //     if(parsedUserConnected !== this.$store.state.userConnected && 
    //       this.$store.state.userConnected.isConnected !== parsedUserConnected.isConnected) 
    //     {
    //       this.$store.state.userConnected = parsedUserConnected
    //     }
    //   }
    // },
    // updated() {
    //   if(localStorage && localStorage.userConnected) {
    //     const parsedUserConnected = JSON.parse(localStorage.userConnected)
    //     if(this.$store.state.userConnected.isConnected !== this.isSession) 
    //     {
    //       this.$store.state.userConnected = parsedUserConnected
    //     }
    //   }
    // },
    // computed: {
    //   isSession() {
    //     console.log("isSession()", this.isSession)
    //     return this.isSession
    //   }
    // },
    methods: {
      disconnectUser: function() {
        this.$store.state.userConnected.isConnected = false
        this.$store.state.userConnected.id = null
        this.$store.state.userConnected.username = ""
        this.$store.state.userConnected.email = ""
        localStorage.userConnected = JSON.stringify({
          isConnected: false,
          id: null,
          username: '',
          email: ''
        })
        router.push('/')
      },
    }
  }
</script>

<style scoped lang="scss">
  .navbar {
    width: 100%;
    height: 100%;
    display: flex;
    margin: 0;
    padding: 10px;
    .navbar-container-title {
      width: 20%;
      height: 100%;
      display: flex;
      justify-content: space-evenly;
      align-items: center;
      .navbar-icon-title {
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        svg {
          fill: #ffffff;
          width: 35px;
        }
      }
      .navbar-title {
        color: white;
        margin: 0;
        font-size: 28px;
        width: fit-content;
      }
    }
    .navbar-container-items {
      width: 60%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      .navbar-list-items {
        width: 80%;
        height: 100%;
        list-style: none;
        display: flex;
        justify-content: space-between;
        .navbar-items {
          display: flex;
          justify-content: center;
          align-items: center;
          a {
            color: #ffffff;
            font-weight: 400;
            font-size: 18px;
          }
        }
      }
      }
    .navbar-container-disconnect {
      width: 20%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  }
</style>
